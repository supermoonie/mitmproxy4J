<html lang="zh-CN">
<head>
    <title>mitmproxy4J</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="third/element-ui/css/element-ui.css">
    <link rel="stylesheet" href="third/highlight/css/default.css">
    <link rel="stylesheet" href="third/highlight/css/github.css">
    <link rel="stylesheet" href="css/main.css">
    <script src="third/vue/vue@2.6.11.js"></script>
    <script src="third/element-ui/element-ui@2.13.2.js"></script>
    <script src="third/axios/axios.min.js"></script>
    <script src="third/highlight/highlight.pack.js"></script>
    <script src="third/crypto-js/crypto-js.js"></script>
    <script src="third/crypto-js/cipher-core.js"></script>
    <script src="third/crypto-js/format-hex.js"></script>
    <script src="third/dplayer/hls.js"></script>
    <script src="third/dplayer/DPlayer.min.js"></script>
    <style>
        #menu {
            border: 1px solid #ccc;
            background: #eee;
            position: absolute;
            width: 100px;
            height: 120px;
            display: none;
            z-index: 99;
        }

        [v-cloak] {
            display: none;
        }
    </style>
    <script>
        window.onload = function () {
            let menu = document.getElementById('menu');
            document.onclick = function () {
                menu.style.display = 'none';
            }
        }
    </script>
</head>
<body>
<div id="menu">
    <ul>
        <li><a href="#">分享</a></li>
        <li><a href="#">收藏</a></li>
        <li><a href="#">举报</a></li>
    </ul>
</div>
<div id="main">
    <!--video dialog begin-->
    <div class="p-video-container">
        <el-dialog title="Video" top="10vh" :visible.sync="videoDialogVisible" @opened="videoDialogOpened"
                   @close="videoDialogClose">
            <div id="dPlayer"></div>
        </el-dialog>
    </div>
    <!--video dialog end-->

    <!--request edit dialog begin-->
    <div class="p-request-edit-container" v-cloak>
        <el-dialog title="Edit" top="10vh" :visible.sync="edit.requestDialogVisible">
            <el-tabs v-model="edit.activeTab">
                <el-tab-pane v-for="(item, index) in edit.tabs" :key="item" :label="item">
                    <!-- URL edit begin -->
                    <div v-if="item === 'URL'">
                        <div class="p-placeholder"></div>
                        <div class="p-url-header">
                            <el-input placeholder="https://www.example.com/path" v-model="edit.request.url" class="input-with-select">
                                <el-select v-model="edit.request.method" value-key="item" slot="prepend" @change="requestMethodChanged">
                                    <el-option v-for="(item, key) in edit.request.allowMethods" :key="key" :label="item" :value="item"></el-option>
                                </el-select>
                            </el-input>
                        </div>
                        <div class="p-placeholder"></div>
                        <div class="p-url-body" height="450">
                            <el-table :data="edit.query.data" stripe border height="450" style="width: 100%">
                                <el-table-column label="#" type="index" align="center"></el-table-column>
                                <el-table-column prop="name" label="Name">
                                    <template slot-scope="scope">
                                        <span v-if="scope.row.editing">
                                            <el-input size="mini" v-model="edit.query.select['name']"></el-input>
                                        </span>
                                        <span v-else>{{scope.row['name']}}</span>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="value" label="Value">
                                    <template slot-scope="scope">
                                        <span v-if="scope.row.editing">
                                            <el-input size="mini" v-model="edit.query.select['value']"></el-input>
                                        </span>
                                        <span v-else>{{scope.row['value']}}</span>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Operation" align="center" width="150">
                                    <template slot-scope="scope">
                                        <el-link type="primary" @click="rowEditClicked(scope.row, scope.$index, true, 'query')">{{scope.row.editing ? 'Ok' : 'Edit'}}</el-link>&nbsp;&nbsp;
                                        <el-link type="danger" v-if="!scope.row.editing" @click="rowDeleteClicked(scope.row, scope.$index, 'query')">Delete</el-link>&nbsp;&nbsp;
                                        <el-link type="info" v-else @click="rowEditClicked(scope.row, scope.$index, false, 'query')">Cancel</el-link>
                                    </template>
                                </el-table-column>
                            </el-table>
                        </div>
                        <div class="p-placeholder"></div>
                        <div class="p-url-footer p-select-none">
                            <el-col span="24">
                                <div @click="addClicked('query')"><span>+ Add</span></div>
                            </el-col>
                        </div>
                    </div>
                    <!-- URL edit end -->
                    <!-- Header edit begin -->
                    <div v-if="item === 'Headers'">
                        <div class="p-placeholder"></div>
                        <div class="p-url-body" style="height: 500px;">
                            <el-table :data="edit.headers.data" row-key="name" stripe border height="500" style="width: 100%">
                                <el-table-column label="#" type="index" align="center"></el-table-column>
                                <el-table-column prop="name" label="Name">
                                    <template slot-scope="scope">
                                        <span v-if="scope.row.editing">
                                            <el-input size="mini" v-model="edit.headers.select['name']"></el-input>
                                        </span>
                                        <span v-else>{{scope.row['name']}}</span>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="value" label="Value">
                                    <template slot-scope="scope">
                                        <span v-if="scope.row.editing">
                                            <el-input size="mini" v-model="edit.headers.select['value']"></el-input>
                                        </span>
                                        <span v-else>{{scope.row['value']}}</span>
                                    </template>
                                </el-table-column>
                                <el-table-column label="Operation" align="center" width="150">
                                    <template slot-scope="scope">
                                        <el-link type="primary" @click="rowEditClicked(scope.row, scope.$index, true, 'headers')">{{scope.row.editing ? 'Ok' : 'Edit'}}</el-link>&nbsp;&nbsp;
                                        <el-link type="danger" v-if="!scope.row.editing" @click="rowDeleteClicked(scope.row, scope.$index, 'headers')">Delete</el-link>&nbsp;&nbsp;
                                        <el-link type="info" v-else @click="rowEditClicked(scope.row, scope.$index, false, 'headers')">Cancel</el-link>
                                    </template>
                                </el-table-column>
                            </el-table>
                        </div>
                        <div class="p-placeholder"></div>
                        <div class="p-url-footer p-select-none">
                            <el-col span="24">
                                <div @click="addClicked('headers')"><span>+ Add</span></div>
                            </el-col>
                        </div>
                    </div>
                    <!-- Header edit end -->
                    <!-- Text edit begin -->
                    <div v-if="item === 'Text'">
                        <div class="p-placeholder"></div>
                        <div class="p-url-body" style="height: 552px;">
                            <el-input type="textarea" :rows="2" v-model="edit.text">
                            </el-input>
                        </div>
                    </div>
                    <!-- Text edit end -->
                    <!-- Form edit begin -->
                    <div v-if="item === 'Form'">
                        Form
                    </div>
                    <!-- Form edit end -->
                </el-tab-pane>
            </el-tabs>
            <div slot="footer" class="dialog-footer" align="center">
                <el-button type="primary" plain>Execute</el-button>
                <el-button type="info" plain @click="edit.requestDialogVisible = false">Cancel</el-button>
            </div>
        </el-dialog>
    </div>
    <!--request edit dialog end-->

    <!--header开始-->
    <div class="p-header">
        <div class="p-menus p-border-bottom">
            <el-menu v-cloak :default-active="'1'" class="p-menu" menu-trigger="hover" mode="horizontal"
                     @select="handleSelect">
                <el-submenu index="1">
                    <template slot="title">File</template>
                    <el-menu-item index="1-1">Open...</el-menu-item>
                    <el-menu-item index="1-2">Save...</el-menu-item>
                </el-submenu>
                <el-submenu index="2">
                    <template slot="title">Proxy</template>
                    <el-menu-item index="2-1">Start Record...</el-menu-item>
                    <el-menu-item index="2-2">Start Throttling...</el-menu-item>
                    <el-menu-item index="2-3">Open Windows Proxy</el-menu-item>
                    <el-menu-item index="2-4">Proxy Settings...</el-menu-item>
                </el-submenu>
                <el-submenu index="3">
                    <template slot="title">Tools</template>
                    <el-menu-item index="3-1">Map Remote...</el-menu-item>
                    <el-menu-item index="3-2">Map Local...</el-menu-item>
                    <el-menu-item index="3-3">Black List...</el-menu-item>
                    <el-menu-item index="3-4">White List...</el-menu-item>
                </el-submenu>
                <el-submenu index="4">
                    <template slot="title">Help</template>
                    <el-menu-item index="4-1">Download Root Certificate</el-menu-item>
                    <el-menu-item index="4-2">Check For Update</el-menu-item>
                    <el-menu-item index="4-3">About mitmproxy4J</el-menu-item>
                </el-submenu>
            </el-menu>
        </div>
        <div class="p-tools p-border-bottom">
            <div class="p-tool">
                <i class="el-icon-delete p-icon" @click="clear()"></i>
                <i class="el-icon-edit p-icon" @click="requestEditClicked()"></i>
                <i class="el-icon-search p-icon"></i>
            </div>
        </div>
    </div>
    <!--header结束-->

    <!--aside & main 开始-->
    <div class="p-container">
        <div class="p-container-inner">
            <!--aside 开始-->
            <div class="p-aside" id="p-aside">
                <div class="p-search p-border-bottom">
                    <span class="p-filter">Filter:</span>
                    <el-input class="p-url-filter" @input="filter()"
                              size="mini"
                              clearable="true" v-model="urlFilter"></el-input>
                </div>
                <div class="p-list-container" id="p-list-container">
                    <ul class="p-list" id="p-url-list">
                        <li v-cloak v-for="flow in showFlows" :key="flow.request.id">
                            <el-link :underline="false" :title="flow.request.uri"
                                     :class="{'p-url-active': currentFlowId == flow.request.id}"
                                     v-on:click="handleUrlClicked(flow.request.id, flow, $event)">
                                {{ flow.request.uri }}
                            </el-link>
                        </li>
                    </ul>
                </div>
            </div>
            <!--aside 结束-->
            <el-divider id="p-resize-controller" class="p-divider" direction="vertical"></el-divider>
            <!--main 开始-->
            <div class="p-main" id="p-main">
                <el-tabs v-model="activeName" class="p-tabs">
                    <!--overview 开始-->
                    <el-tab-pane label="Overview" name="Overview">
                        <el-table :data="current.overview" border="true" stripe fit="true" :show-header="false"
                                  :row-class-name="overviewRowClassName">
                            <el-table-column prop="name" label="Name" width="200"></el-table-column>
                            <el-table-column prop="value" label="Value"></el-table-column>
                        </el-table>
                    </el-tab-pane>
                    <!--overview 结束-->

                    <!--request 开始-->
                    <el-tab-pane label="Request" name="Request">
                        <el-tabs :tab-position="'left'">
                            <el-tab-pane label="Headers">
                                <el-table :data="current.request.headers" border="true" stripe fit="true">
                                    <el-table-column prop="name" label="Name" width="200"></el-table-column>
                                    <el-table-column prop="value" label="Value"></el-table-column>
                                </el-table>
                            </el-tab-pane>
                            <el-tab-pane label="Query">
                                <el-table :data="current.request.queryString" border="true" stripe fit="true">
                                    <el-table-column prop="name" label="Name" width="200"></el-table-column>
                                    <el-table-column prop="value" label="Value"></el-table-column>
                                </el-table>
                            </el-tab-pane>
                            <el-tab-pane label="Cookies">
                                <el-table :data="current.request.cookies" border="true" stripe fit="true">
                                    <el-table-column prop="name" label="Name" width="200"></el-table-column>
                                    <el-table-column prop="value" label="Value"></el-table-column>
                                </el-table>
                            </el-tab-pane>
                            <el-tab-pane label="Raw">
                                <div v-html="current.request.raw" class="p-raw"></div>
                            </el-tab-pane>
                        </el-tabs>
                    </el-tab-pane>
                    <!--request 结束-->

                    <!--response 开始-->
                    <el-tab-pane label="Response" name="Response">
                        <el-tabs :tab-position="'left'">
                            <el-tab-pane v-model="activeResponsePanel" v-for="(item, index) in responseTabs" :key="item"
                                         :label="item">
                                <!-- response.headers 开始-->
                                <el-table :data="current.response.headers" border="true" stripe fit="true"
                                          v-if="item === 'Headers'">
                                    <el-table-column prop="name" label="Name" width="200"></el-table-column>
                                    <el-table-column prop="value" label="Value"></el-table-column>
                                </el-table>
                                <!-- response.headers 结束-->
                                <!-- response.cookies 开始-->
                                <el-table :data="current.response.cookies" border="true" stripe fit="true"
                                          v-if="item === 'Cookies'">
                                    <el-table-column prop="name" label="Name"></el-table-column>
                                    <el-table-column prop="value" label="Value"></el-table-column>
                                    <el-table-column prop="path" label="Path"></el-table-column>
                                    <el-table-column prop="Max-Age" label="Max-Age" width="90"></el-table-column>
                                    <el-table-column prop="expires" label="expires" width="180"></el-table-column>
                                    <el-table-column prop="SameSite" label="SameSite" width="90"></el-table-column>
                                    <el-table-column prop="HTTPOnly" label="HttpOnly" width="80"></el-table-column>
                                    <el-table-column prop="secure" label="Secure" width="80"></el-table-column>
                                </el-table>
                                <!-- response.cookies 结束-->
                                <!-- response.raw 开始-->
                                <div v-if="item === 'Raw'">
                                    <div v-html="current.response.raw" v-show="!!current.response.raw" v-highlight
                                         class="p-raw"></div>
                                    <div class="el-table__empty-block" v-show="!current.response.raw"
                                         style="width: 1264px; height: 100%;">
                                        <span class="el-table__empty-text">暂无数据</span>
                                    </div>
                                </div>
                                <!-- response.raw 结束-->
                                <!-- response.json 开始-->
                                <div v-if="item === 'JSON'">
                                    <div v-html="current.response.json" v-highlight class="p-raw"></div>
                                </div>
                                <!-- response.json 结束-->
                                <!-- response.html 开始-->
                                <div v-if="item === 'HTML'">
                                    <div v-html="current.response.html" v-highlight class="p-raw"></div>
                                </div>
                                <!-- response.html 结束-->
                                <!-- response.image 开始-->
                                <div v-if="item === 'Image'">
                                    <div v-html="current.response.image" v-highlight class="p-raw"></div>
                                </div>
                                <!-- response.image 结束-->
                                <!-- response.video 开始-->
                                <div v-if="item === 'Video'">
                                    <el-button type="primary" plain icon="el-icon-video-play" @click="videoDialogVisible = true">Try Play
                                    </el-button>
                                </div>
                                <!-- response.video 结束-->
                                <!-- response.plain 开始-->
                                <div v-if="item === 'Plain'">
                                    <div v-html="current.response.plain" v-highlight class="p-raw"></div>
                                </div>
                                <!-- response.plain 结束-->
                            </el-tab-pane>
                        </el-tabs>
                    </el-tab-pane>
                    <!--response 结束-->
                </el-tabs>
            </div>
            <!--main 结束-->
        </div>
    </div>
    <!--aside & main 结束-->
</div>
</body>
<script type="application/javascript" src="js/main.js"></script>
</html>